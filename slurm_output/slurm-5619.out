args: Namespace(seed=42, text_max_len=512, num_train_epochs=1, model_class='QAMatchModel', dataset_name='hard_msmarco', label_num=0, composition='pooler', context_num=1, pretrained_bert_path='Luyu/co-condenser-marco-retriever', model_save_prefix='no_apex-', top_layer_num=3, first_seq_max_len=256, train_candidate_num=-1, used_layers=None, one_stage=False, evaluate_epoch=1, no_aggregator=False, no_enricher=False, no_apex=False, no_train=False, do_test=False, do_real_test=False, query_block_size=200, do_val=False, use_cpu=False, in_batch=False, nvidia_number='1', restore=False, val_batch_size=2, train_batch_size=8, gradient_accumulation_steps=1, step_max_query_num=8, clean_graph=False, no_initial_test=True, only_final=False, load_model=False, load_model_path=None, save_model_dict='/data/cme/mix/model/', last_model_dict='/data/cme/mix/last_model/', load_middle=False, distill=False, teacher_path='./model/teacher', mlm=False, teacher_loss=False, alpha=0.5, local_rank=0, data_parallel=False, data_distribute=False, dataset_split_num=20, first_stage_lr=0.3)
local rank: 0
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ begin one stage train ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
---------------------- create model ----------------------
--------------------- model  created ---------------------
train_step_function is match_train_step_for_qa_input
[{'params': <generator object Module.parameters at 0x7fbc7811f300>, 'lr': 1e-05}]
******************************
Loading hard_msmarco_train from disk...
**************************************************
******************** 1 ********************
**************************************************
Training epoch is 1
**************************************************
Train 1 epochs, Block num 20, Accumulate num 1, Total update 62006, Remain update 62006

  0%|          | 0/62006 [00:00<?, ?it/s]epoch   1 loss 2.0908:   0%|          | 0/62006 [00:01<?, ?it/s]epoch   1 loss 2.0908:   0%|          | 1/62006 [00:01<34:14:11,  1.99s/it]epoch   1 loss 2.2038:   0%|          | 1/62006 [00:03<34:14:11,  1.99s/it]epoch   1 loss 2.2038:   0%|          | 2/62006 [00:03<30:21:25,  1.76s/it]epoch   1 loss 2.2800:   0%|          | 2/62006 [00:05<30:21:25,  1.76s/it]epoch   1 loss 2.2800:   0%|          | 3/62006 [00:05<29:07:40,  1.69s/it]epoch   1 loss 2.5173:   0%|          | 3/62006 [00:06<29:07:40,  1.69s/it]epoch   1 loss 2.5173:   0%|          | 4/62006 [00:06<28:35:15,  1.66s/it]epoch   1 loss 2.5926:   0%|          | 4/62006 [00:08<28:35:15,  1.66s/it]epoch   1 loss 2.5926:   0%|          | 5/62006 [00:08<28:17:10,  1.64s/it]epoch   1 loss 2.4888:   0%|          | 5/62006 [00:10<28:17:10,  1.64s/it]epoch   1 loss 2.4888:   0%|          | 6/62006 [00:10<28:07:34,  1.63s/it]epoch   1 loss 2.4216:   0%|          | 6/62006 [00:11<28:07:34,  1.63s/it]epoch   1 loss 2.4216:   0%|          | 7/62006 [00:11<28:02:05,  1.63s/it]epoch   1 loss 2.3603:   0%|          | 7/62006 [00:13<28:02:05,  1.63s/it]epoch   1 loss 2.3603:   0%|          | 8/62006 [00:13<27:58:46,  1.62s/it]epoch   1 loss 2.3919:   0%|          | 8/62006 [00:14<27:58:46,  1.62s/it]epoch   1 loss 2.3919:   0%|          | 9/62006 [00:14<27:57:06,  1.62s/it]epoch   1 loss 2.4844:   0%|          | 9/62006 [00:16<27:57:06,  1.62s/it]epoch   1 loss 2.4844:   0%|          | 10/62006 [00:16<27:56:04,  1.62s/it]epoch   1 loss 2.5420:   0%|          | 10/62006 [00:18<27:56:04,  1.62s/it]epoch   1 loss 2.5420:   0%|          | 11/62006 [00:18<27:55:06,  1.62s/it]epoch   1 loss 2.4644:   0%|          | 11/62006 [00:19<27:55:06,  1.62s/it]epoch   1 loss 2.4644:   0%|          | 12/62006 [00:19<27:54:56,  1.62s/it]epoch   1 loss 2.4769:   0%|          | 12/62006 [00:21<27:54:56,  1.62s/it]epoch   1 loss 2.4769:   0%|          | 13/62006 [00:21<27:54:17,  1.62s/it]epoch   1 loss 2.4620:   0%|          | 13/62006 [00:22<27:54:17,  1.62s/it]epoch   1 loss 2.4620:   0%|          | 14/62006 [00:22<27:56:07,  1.62s/it]epoch   1 loss 2.5317:   0%|          | 14/62006 [00:24<27:56:07,  1.62s/it]epoch   1 loss 2.5317:   0%|          | 15/62006 [00:24<27:58:56,  1.63s/it]epoch   1 loss 2.4942:   0%|          | 15/62006 [00:26<27:58:56,  1.63s/it]epoch   1 loss 2.4942:   0%|          | 16/62006 [00:26<27:58:35,  1.62s/it]epoch   1 loss 2.4913:   0%|          | 16/62006 [00:27<27:58:35,  1.62s/it]epoch   1 loss 2.4913:   0%|          | 17/62006 [00:27<28:00:10,  1.63s/it]epoch   1 loss 2.5775:   0%|          | 17/62006 [00:29<28:00:10,  1.63s/it]epoch   1 loss 2.5775:   0%|          | 18/62006 [00:29<28:03:48,  1.63s/it]epoch   1 loss 2.4905:   0%|          | 18/62006 [00:31<28:03:48,  1.63s/it]epoch   1 loss 2.4905:   0%|          | 19/62006 [00:31<28:03:48,  1.63s/it]epoch   1 loss 2.5005:   0%|          | 19/62006 [00:32<28:03:48,  1.63s/it]epoch   1 loss 2.5005:   0%|          | 20/62006 [00:32<28:04:59,  1.63s/it]epoch   1 loss 2.4836:   0%|          | 20/62006 [00:34<28:04:59,  1.63s/it]epoch   1 loss 2.4836:   0%|          | 21/62006 [00:34<28:00:49,  1.63s/it]epoch   1 loss 2.5560:   0%|          | 21/62006 [00:36<28:00:49,  1.63s/it]epoch   1 loss 2.5560:   0%|          | 22/62006 [00:36<27:59:34,  1.63s/it]epoch   1 loss 2.5947:   0%|          | 22/62006 [00:37<27:59:34,  1.63s/it]epoch   1 loss 2.5947:   0%|          | 23/62006 [00:37<27:59:57,  1.63s/it]epoch   1 loss 2.6942:   0%|          | 23/62006 [00:39<27:59:57,  1.63s/it]epoch   1 loss 2.6942:   0%|          | 24/62006 [00:39<27:57:38,  1.62s/it]epoch   1 loss 2.6685:   0%|          | 24/62006 [00:40<27:57:38,  1.62s/it]epoch   1 loss 2.6685:   0%|          | 25/62006 [00:40<27:55:12,  1.62s/it]epoch   1 loss 2.7078:   0%|          | 25/62006 [00:42<27:55:12,  1.62s/it]epoch   1 loss 2.7078:   0%|          | 26/62006 [00:42<27:58:40,  1.63s/it]epoch   1 loss 2.6734:   0%|          | 26/62006 [00:44<27:58:40,  1.63s/it]epoch   1 loss 2.6734:   0%|          | 27/62006 [00:44<27:58:02,  1.62s/it]epoch   1 loss 2.6608:   0%|          | 27/62006 [00:45<27:58:02,  1.62s/it]epoch   1 loss 2.6608:   0%|          | 28/62006 [00:45<27:56:00,  1.62s/it]epoch   1 loss 2.6681:   0%|          | 28/62006 [00:47<27:56:00,  1.62s/it]epoch   1 loss 2.6681:   0%|          | 29/62006 [00:47<27:56:00,  1.62s/it]epoch   1 loss 2.6672:   0%|          | 29/62006 [00:49<27:56:00,  1.62s/it]epoch   1 loss 2.6672:   0%|          | 30/62006 [00:49<27:58:08,  1.62s/it]epoch   1 loss 2.6713:   0%|          | 30/62006 [00:50<27:58:08,  1.62s/it]epoch   1 loss 2.6713:   0%|          | 31/62006 [00:50<27:58:41,  1.63s/it]epoch   1 loss 2.6993:   0%|          | 31/62006 [00:52<27:58:41,  1.63s/it]epoch   1 loss 2.6993:   0%|          | 32/62006 [00:52<27:58:33,  1.63s/it]epoch   1 loss 2.7118:   0%|          | 32/62006 [00:53<27:58:33,  1.63s/it]epoch   1 loss 2.7118:   0%|          | 33/62006 [00:53<27:59:32,  1.63s/it]epoch   1 loss 2.7172:   0%|          | 33/62006 [00:55<27:59:32,  1.63s/it]epoch   1 loss 2.7172:   0%|          | 34/62006 [00:55<27:59:49,  1.63s/it]epoch   1 loss 2.7376:   0%|          | 34/62006 [00:57<27:59:49,  1.63s/it]epoch   1 loss 2.7376:   0%|          | 35/62006 [00:57<28:01:12,  1.63s/it]epoch   1 loss 2.7898:   0%|          | 35/62006 [00:58<28:01:12,  1.63s/it]epoch   1 loss 2.7898:   0%|          | 36/62006 [00:58<28:01:55,  1.63s/it]epoch   1 loss 2.7870:   0%|          | 36/62006 [01:00<28:01:55,  1.63s/it]epoch   1 loss 2.7870:   0%|          | 37/62006 [01:00<28:01:11,  1.63s/it]epoch   1 loss 2.7630:   0%|          | 37/62006 [01:02<28:01:11,  1.63s/it]epoch   1 loss 2.7630:   0%|          | 38/62006 [01:02<28:03:50,  1.63s/it]epoch   1 loss 2.7682:   0%|          | 38/62006 [01:03<28:03:50,  1.63s/it]epoch   1 loss 2.7682:   0%|          | 39/62006 [01:03<28:03:52,  1.63s/it]epoch   1 loss 2.7714:   0%|          | 39/62006 [01:05<28:03:52,  1.63s/it]epoch   1 loss 2.7714:   0%|          | 40/62006 [01:05<28:03:04,  1.63s/it]epoch   1 loss 2.7775:   0%|          | 40/62006 [01:06<28:03:04,  1.63s/it]epoch   1 loss 2.7775:   0%|          | 41/62006 [01:06<28:02:54,  1.63s/it]epoch   1 loss 2.8113:   0%|          | 41/62006 [01:08<28:02:54,  1.63s/it]epoch   1 loss 2.8113:   0%|          | 42/62006 [01:08<28:05:08,  1.63s/it]epoch   1 loss 2.8011:   0%|          | 42/62006 [01:10<28:05:08,  1.63s/it]epoch   1 loss 2.8011:   0%|          | 43/62006 [01:10<28:05:15,  1.63s/it]epoch   1 loss 2.8015:   0%|          | 43/62006 [01:11<28:05:15,  1.63s/it]epoch   1 loss 2.8015:   0%|          | 44/62006 [01:11<28:06:14,  1.63s/it]epoch   1 loss 2.8200:   0%|          | 44/62006 [01:13<28:06:14,  1.63s/it]epoch   1 loss 2.8200:   0%|          | 45/62006 [01:13<28:06:52,  1.63s/it]epoch   1 loss 2.7996:   0%|          | 45/62006 [01:15<28:06:52,  1.63s/it]epoch   1 loss 2.7996:   0%|          | 46/62006 [01:15<28:05:15,  1.63s/it]epoch   1 loss 2.7867:   0%|          | 46/62006 [01:16<28:05:15,  1.63s/it]epoch   1 loss 2.7867:   0%|          | 47/62006 [01:16<28:06:51,  1.63s/it]epoch   1 loss 2.7788:   0%|          | 47/62006 [01:18<28:06:51,  1.63s/it]epoch   1 loss 2.7788:   0%|          | 48/62006 [01:18<28:09:41,  1.64s/it]epoch   1 loss 2.7823:   0%|          | 48/62006 [01:20<28:09:41,  1.64s/it]epoch   1 loss 2.7823:   0%|          | 49/62006 [01:20<28:08:37,  1.64s/it]epoch   1 loss 2.7985:   0%|          | 49/62006 [01:21<28:08:37,  1.64s/it]epoch   1 loss 2.7985:   0%|          | 50/62006 [01:21<28:09:39,  1.64s/it]epoch   1 loss 2.7839:   0%|          | 50/62006 [01:23<28:09:39,  1.64s/it]epoch   1 loss 2.7839:   0%|          | 51/62006 [01:23<28:09:50,  1.64s/it]epoch   1 loss 2.7895:   0%|          | 51/62006 [01:24<28:09:50,  1.64s/it]epoch   1 loss 2.7895:   0%|          | 52/62006 [01:24<28:10:35,  1.64s/it]epoch   1 loss 2.7668:   0%|          | 52/62006 [01:26<28:10:35,  1.64s/it]epoch   1 loss 2.7668:   0%|          | 53/62006 [01:26<28:10:33,  1.64s/it]epoch   1 loss 2.7527:   0%|          | 53/62006 [01:28<28:10:33,  1.64s/it]epoch   1 loss 2.7527:   0%|          | 54/62006 [01:28<28:08:54,  1.64s/it]epoch   1 loss 2.7459:   0%|          | 54/62006 [01:29<28:08:54,  1.64s/it]epoch   1 loss 2.7459:   0%|          | 55/62006 [01:29<28:08:40,  1.64s/it]epoch   1 loss 2.7596:   0%|          | 55/62006 [01:31<28:08:40,  1.64s/it]epoch   1 loss 2.7596:   0%|          | 56/62006 [01:31<28:10:53,  1.64s/it]epoch   1 loss 2.7451:   0%|          | 56/62006 [01:33<28:10:53,  1.64s/it]epoch   1 loss 2.7451:   0%|          | 57/62006 [01:33<28:11:19,  1.64s/it]epoch   1 loss 2.7447:   0%|          | 57/62006 [01:34<28:11:19,  1.64s/it]epoch   1 loss 2.7447:   0%|          | 58/62006 [01:34<28:11:44,  1.64s/it]epoch   1 loss 2.7392:   0%|          | 58/62006 [01:36<28:11:44,  1.64s/it]epoch   1 loss 2.7392:   0%|          | 59/62006 [01:36<28:10:20,  1.64s/it]epoch   1 loss 2.7312:   0%|          | 59/62006 [01:38<28:10:20,  1.64s/it]epoch   1 loss 2.7312:   0%|          | 60/62006 [01:38<28:11:33,  1.64s/it]epoch   1 loss 2.7260:   0%|          | 60/62006 [01:39<28:11:33,  1.64s/it]epoch   1 loss 2.7260:   0%|          | 61/62006 [01:39<28:10:02,  1.64s/it]epoch   1 loss 2.7129:   0%|          | 61/62006 [01:41<28:10:02,  1.64s/it]epoch   1 loss 2.7129:   0%|          | 62/62006 [01:41<28:08:32,  1.64s/it]epoch   1 loss 2.7080:   0%|          | 62/62006 [01:42<28:08:32,  1.64s/it]epoch   1 loss 2.7080:   0%|          | 63/62006 [01:42<28:07:54,  1.63s/it]epoch   1 loss 2.7125:   0%|          | 63/62006 [01:44<28:07:54,  1.63s/it]epoch   1 loss 2.7125:   0%|          | 64/62006 [01:44<28:08:02,  1.64s/it]epoch   1 loss 2.7163:   0%|          | 64/62006 [01:46<28:08:02,  1.64s/it]epoch   1 loss 2.7163:   0%|          | 65/62006 [01:46<28:09:12,  1.64s/it]epoch   1 loss 2.7281:   0%|          | 65/62006 [01:47<28:09:12,  1.64s/it]epoch   1 loss 2.7281:   0%|          | 66/62006 [01:47<28:09:43,  1.64s/it]epoch   1 loss 2.7183:   0%|          | 66/62006 [01:49<28:09:43,  1.64s/it]epoch   1 loss 2.7183:   0%|          | 67/62006 [01:49<28:09:43,  1.64s/it]epoch   1 loss 2.7101:   0%|          | 67/62006 [01:51<28:09:43,  1.64s/it]epoch   1 loss 2.7101:   0%|          | 68/62006 [01:51<28:07:32,  1.63s/it]epoch   1 loss 2.7264:   0%|          | 68/62006 [01:52<28:07:32,  1.63s/it]epoch   1 loss 2.7264:   0%|          | 69/62006 [01:52<28:07:35,  1.63s/it]epoch   1 loss 2.7147:   0%|          | 69/62006 [01:54<28:07:35,  1.63s/it]epoch   1 loss 2.7147:   0%|          | 70/62006 [01:54<28:08:07,  1.64s/it]epoch   1 loss 2.7082:   0%|          | 70/62006 [01:56<28:08:07,  1.64s/it]epoch   1 loss 2.7082:   0%|          | 71/62006 [01:56<28:07:44,  1.64s/it]epoch   1 loss 2.7089:   0%|          | 71/62006 [01:57<28:07:44,  1.64s/it]epoch   1 loss 2.7089:   0%|          | 72/62006 [01:57<28:07:43,  1.64s/it]epoch   1 loss 2.6855:   0%|          | 72/62006 [01:59<28:07:43,  1.64s/it]epoch   1 loss 2.6855:   0%|          | 73/62006 [01:59<28:06:50,  1.63s/it]epoch   1 loss 2.6868:   0%|          | 73/62006 [02:00<28:06:50,  1.63s/it]epoch   1 loss 2.6868:   0%|          | 74/62006 [02:00<28:07:59,  1.64s/it]epoch   1 loss 2.6935:   0%|          | 74/62006 [02:02<28:07:59,  1.64s/it]epoch   1 loss 2.6935:   0%|          | 75/62006 [02:02<28:08:02,  1.64s/it]epoch   1 loss 2.6947:   0%|          | 75/62006 [02:04<28:08:02,  1.64s/it]epoch   1 loss 2.6947:   0%|          | 76/62006 [02:04<28:07:00,  1.63s/it]epoch   1 loss 2.6917:   0%|          | 76/62006 [02:05<28:07:00,  1.63s/it]epoch   1 loss 2.6917:   0%|          | 77/62006 [02:05<28:07:06,  1.63s/it]epoch   1 loss 2.7040:   0%|          | 77/62006 [02:07<28:07:06,  1.63s/it]epoch   1 loss 2.7040:   0%|          | 78/62006 [02:07<28:08:47,  1.64s/it]epoch   1 loss 2.7100:   0%|          | 78/62006 [02:09<28:08:47,  1.64s/it]epoch   1 loss 2.7100:   0%|          | 79/62006 [02:09<28:09:00,  1.64s/it]epoch   1 loss 2.7069:   0%|          | 79/62006 [02:10<28:09:00,  1.64s/it]epoch   1 loss 2.7069:   0%|          | 80/62006 [02:10<28:06:09,  1.63s/it]epoch   1 loss 2.7241:   0%|          | 80/62006 [02:12<28:06:09,  1.63s/it]epoch   1 loss 2.7241:   0%|          | 81/62006 [02:12<28:08:01,  1.64s/it]slurmstepd-n01: error: *** JOB 5619 ON n01 CANCELLED AT 2024-02-11T11:33:56 ***
